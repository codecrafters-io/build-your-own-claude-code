@@ -6,47 +6,66 @@
 prompt = ""

 OptionParser.parse do |parser|
   parser.on("-p PROMPT", "Prompt to send to LLM") { |p| prompt = p }
 end

 if prompt.empty?
   abort("Prompt must not be empty")
 end

 api_key = ENV["OPENROUTER_API_KEY"]?
 base_url = ENV.fetch("OPENROUTER_BASE_URL", "https://openrouter.ai/api/v1")

 if api_key.nil? || api_key.empty?
   abort("OPENROUTER_API_KEY is not set")
 end

 uri = URI.parse(base_url)
 path = uri.path.rstrip("/") + "/chat/completions"

 body = {
   "model"    => "anthropic/claude-haiku-4.5",
   "messages" => [
     {"role" => "user", "content" => prompt},
   ],
+  "tools" => [
+    {
+      "type"     => "function",
+      "function" => {
+        "name"        => "Read",
+        "description" => "Read and return the contents of a file",
+        "parameters"  => {
+          "type"       => "object",
+          "properties" => {
+            "file_path" => {
+              "type"        => "string",
+              "description" => "The path to the file to read",
+            },
+          },
+          "required" => ["file_path"],
+        },
+      },
+    },
+  ],
 }.to_json

 headers = HTTP::Headers{
   "Authorization" => "Bearer #{api_key}",
   "Content-Type"  => "application/json",
 }

 client = HTTP::Client.new(uri)
 response = client.post(path, headers: headers, body: body)

 if response.status_code != 200
   abort("HTTP error: #{response.status_code} #{response.body}")
 end

 parsed = JSON.parse(response.body)
 choices = parsed["choices"]?

 if choices.nil? || choices.as_a.empty?
   abort("No choices in response")
 end

 print choices[0]["message"]["content"]
